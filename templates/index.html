<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Git Commit/Merge Formatter</title>
    {% include 'components/styles.html' %}
</head>
<body>
    <div class="main-container">
        {% include 'components/git_graph.html' %}
        
        <div class="container">
            <h1>
                Git Commit/Merge Formatter
                <svg class="refresh-icon" onclick="location.reload()" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M23 4v6h-6"></path>
                    <path d="M1 20v-6h6"></path>
                    <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
                </svg>
            </h1>
            <form action="/commit" method="POST">
                <label for="action_type">Select Action:</label>
                <select name="action_type" id="action_type" required>
                    <option value="commit">Commit</option>
                    <option value="merge">Merge</option>
                    <option value="branch">Create Branch</option>
                    <option value="pull">Pull</option>
                    <option value="push">Push</option>
                </select>
                <br><br>

                {% include 'components/commit_form.html' %}

                <!-- Merge 관련 입력 -->
                <div id="merge_fields" style="display: none;">
                    <div class="current-branch-info" onclick="toggleBranchDropdown(this)">
                        <p>
                            Current Branch: <strong>{{ current_branch }}</strong>
                            <span class="dropdown-arrow">▼</span>
                        </p>
                        <div class="branch-dropdown">
                            {% for branch in branches %}
                                <div class="branch-item {% if branch == current_branch %}current{% endif %}" 
                                     onclick="checkoutBranch('{{ branch }}', event)">
                                    {{ branch }}
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                    <br>

                    <label for="source_branch">Source Branch:</label>
                    <select name="source_branch" id="source_branch">
                        {% for branch in branches %}
                            <option value="{{ branch }}" {% if branch == current_branch %}selected{% endif %}>{{ branch }}</option>
                        {% endfor %}
                    </select>
                    <br><br>

                    <label for="target_branch">Target Branch:</label>
                    <select name="target_branch" id="target_branch">
                        {% for branch in branches %}
                            <option value="{{ branch }}">{{ branch }}</option>
                        {% endfor %}
                    </select>
                    <br><br>
                </div>

                <!-- Branch 생성 관련 입력 -->
                <div id="branch_fields" style="display: none;">
                    <div class="current-branch-info" onclick="toggleBranchDropdown(this)">
                        <p>
                            Current Branch: <strong>{{ current_branch }}</strong>
                            <span class="dropdown-arrow">▼</span>
                        </p>
                        <div class="branch-dropdown">
                            {% for branch in branches %}
                                <div class="branch-item {% if branch == current_branch %}current{% endif %}" 
                                     onclick="checkoutBranch('{{ branch }}', event)">
                                    {{ branch }}
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                    <br>

                    <label for="new_branch_name">New Branch Name:</label>
                    <input type="text" id="new_branch_name" name="new_branch_name" placeholder="Enter new branch name">
                    <br><br>

                    <label for="base_branch">Base Branch:</label>
                    <select name="base_branch" id="base_branch">
                        {% for branch in branches %}
                            <option value="{{ branch }}" {% if branch == current_branch %}selected{% endif %}>{{ branch }}</option>
                        {% endfor %}
                    </select>
                    <br><br>
                </div>

                <!-- Pull 관련 입력 -->
                <div id="pull_fields" style="display: none;">
                    <div class="current-branch-info" onclick="toggleBranchDropdown(this)">
                        <p>
                            Current Branch: <strong>{{ current_branch }}</strong>
                            <span class="dropdown-arrow">▼</span>
                        </p>
                        <div class="branch-dropdown">
                            {% for branch in branches %}
                                <div class="branch-item {% if branch == current_branch %}current{% endif %}" 
                                     onclick="checkoutBranch('{{ branch }}', event)">
                                    {{ branch }}
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                    <br>

                    <label for="pull_branch">Pull Branch:</label>
                    <select name="pull_branch" id="pull_branch">
                        {% for branch in branches %}
                            <option value="{{ branch }}" {% if branch == current_branch %}selected{% endif %}>{{ branch }}</option>
                        {% endfor %}
                    </select>
                    <br><br>
                </div>

                <!-- Push 관련 입력 -->
                <div id="push_fields" style="display: none;">
                    <div class="current-branch-info" onclick="toggleBranchDropdown(this)">
                        <p>
                            Current Branch: <strong>{{ current_branch }}</strong>
                            <span class="dropdown-arrow">▼</span>
                        </p>
                        <div class="branch-dropdown">
                            {% for branch in branches %}
                                <div class="branch-item {% if branch == current_branch %}current{% endif %}" 
                                     onclick="checkoutBranch('{{ branch }}', event)">
                                    {{ branch }}
                                </div>
                            {% endfor %}
                        </div>
                    </div>
                    <br>

                    <label for="push_branch">Push Branch:</label>
                    <select name="push_branch" id="push_branch">
                        {% for branch in branches %}
                            <option value="{{ branch }}" {% if branch == current_branch %}selected{% endif %}>{{ branch }}</option>
                        {% endfor %}
                    </select>
                    <br><br>
                </div>

                <div class="button-group">
                    <button type="submit" id="submit_button">Execute</button>
                </div>
            </form>
            <div class="footer">
                <p>Powered by Toothy - Git Commit/Merge Formatter</p>
                <p>Contact: <a href="mailto:business@kklim.io">business@kklim.io</a></p>
            </div>
        </div>
    </div>

    {% include 'components/scripts.html' %}
</body>
</html>
